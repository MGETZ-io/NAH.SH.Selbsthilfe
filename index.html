<script>
    const tree = {
        "1": { 
            text: "Remote / Citrix", 
            next: { 
                "1.1": { text: "Login-Probleme", next: { "1.Ende": "/docs/help/LoginProbleme.html" } },
                "1.2": { text: "Citrix Features", next: { "1.Ende": "/docs/help/CitrixFeatures.html" } }
            } 
        },
        "2": { 
            text: "Lokal / Im Büro", 
            next: { 
                "2.1": { text: "Drucker funktioniert nicht", next: { "2.Ende": "/docs/help/Drucker.html" } },
                "2.2": { text: "Kein Internet", next: { "2.Ende": "/docs/help/Internet.html" } }
            } 
        }
    };

    const container = document.getElementById("selfhelp-container");

    function handleSelection(option, key) {
        option.classList.add("zoom");

        setTimeout(() => {
            option.classList.remove("zoom");

            if (tree[key]?.next) {
                showNextQuestion(tree[key].next);
            } else if (key.endsWith(".Ende")) {
                console.log("Ende erreicht, Weiterleitung zu:", tree[key]);
                window.location.href = tree[key];
            }
        }, 500);
    }

    function showNextQuestion(subTree) {
        container.innerHTML = "";

        const question = document.createElement("p");
        question.classList.add("question");
        question.textContent = "Wähle eine Option:";
        container.appendChild(question);

        const optionsDiv = document.createElement("div");
        optionsDiv.classList.add("options");

        Object.keys(subTree).forEach(subKey => {
            const div = document.createElement("div");
            div.classList.add("option");
            div.textContent = subTree[subKey].text;
            div.onclick = () => handleSelection(div, subKey);
            optionsDiv.appendChild(div);
        });

        container.appendChild(optionsDiv);
    }

    document.querySelectorAll(".option").forEach(option => {
        option.onclick = () => handleSelection(option, option.dataset.class);
    });
</script>

